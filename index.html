<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í™˜ìœ¨ NOW</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto+Sans+KR', sans-serif;
            background-color: #faf9f6; /* Warm Neutral Background */
            color: #2d2d2d;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        .keypad-button {
            transition: all 0.1s ease;
            user-select: none;
        }
        
        .keypad-button:active {
            transform: scale(0.95);
            background-color: #e5e7eb;
        }

        .currency-row {
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .currency-row.active {
            background-color: #ffffff;
            border-color: #2563eb;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        .nav-tab.active {
            color: #2563eb;
            border-bottom: 2px solid #2563eb;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #d1d5db;
            border-radius: 10px;
        }

        .expression-display {
            font-size: 0.75rem;
            color: #9ca3af;
            height: 1rem;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Chosen Palette: Warm Sand & Professional Blue -->
    <!-- Application Structure Plan: 
        1. Navigation: An expanded tabbed interface allowing users to switch between PHP, USD, THB, and VND views.
        2. Dashboard: Dynamic content update based on the selected tab (4 currencies supported).
        3. Real-time Logic: Implemented a calculator parser that handles +, -, *, / in real-time.
        4. Information Architecture: Unified multi-country view into one seamless SPA with integrated calculation logic.
        5. Justification: Adding math operators directly to the keypad enhances utility for travelers calculating split bills or shopping totals.
    -->

    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
        <header class="mb-8">
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-xl" id="logo-icon">â‚±</div>
                    <h1 class="text-xl font-bold text-gray-800">í™˜ìœ¨ NOW</h1>
                </div>
                <div class="text-xs text-gray-400 font-medium" id="last-updated">
                    ì—…ë°ì´íŠ¸: 2026ë…„ 2ì›” 14ì¼ 21:03
                </div>
            </div>
            
            <nav class="flex border-b border-gray-200 overflow-x-auto whitespace-nowrap scrollbar-hide">
                <button onclick="switchView('PHP')" id="nav-php" class="nav-tab active px-4 sm:px-6 py-2 font-bold text-sm transition-all">í˜ì†Œ (PHP)</button>
                <button onclick="switchView('USD')" id="nav-usd" class="nav-tab px-4 sm:px-6 py-2 font-bold text-sm text-gray-400 transition-all">ë‹¬ëŸ¬ (USD)</button>
                <button onclick="switchView('THB')" id="nav-thb" class="nav-tab px-4 sm:px-6 py-2 font-bold text-sm text-gray-400 transition-all">ë°”íŠ¸ (THB)</button>
                <button onclick="switchView('VND')" id="nav-vnd" class="nav-tab px-4 sm:px-6 py-2 font-bold text-sm text-gray-400 transition-all">ë™ (VND)</button>
            </nav>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- ë¦¬í¬íŠ¸ ì„¹ì…˜ 1: ì‹¤ì‹œê°„ ê³„ì‚°ê¸° -->
            <section class="lg:col-span-5 space-y-6">
                <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-6">
                    <h2 class="text-lg font-bold mb-4 px-2" id="dashboard-title">ì–‘ë°©í–¥ í˜ì†Œ ë³€í™˜</h2>
                    <p class="text-sm text-gray-500 mb-6 px-2 leading-relaxed" id="dashboard-desc">
                        ì‚¬ì¹™ì—°ì‚°ì„ ì§€ì›í•˜ëŠ” ê³„ì‚°ê¸° ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ìˆ«ìì™€ ì—°ì‚°ìë¥¼ ì…ë ¥í•˜ì—¬ ì¦‰ì„ì—ì„œ í•©ê³„ë¥¼ êµ¬í•˜ê³  í™˜ìœ¨ì„ í™•ì¸í•˜ì„¸ìš”.
                    </p>

                    <!-- í†µí™” ë¦¬ìŠ¤íŠ¸ -->
                    <div class="space-y-3 mb-8" id="currency-list">
                        <!-- Target Currency Row -->
                        <div id="row-target" class="currency-row active flex items-center justify-between p-4 rounded-2xl cursor-pointer bg-gray-50" data-code="PHP">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl" id="target-flag">ğŸ‡µğŸ‡­</span>
                                <span class="font-bold text-gray-700" id="target-code">PHP</span>
                                <span class="text-blue-600 text-xs font-bold active-label">ì…ë ¥ ì¤‘</span>
                            </div>
                            <div class="text-right">
                                <div class="expression-display" id="expr-PHP"></div>
                                <div class="text-xl font-bold tracking-tight text-blue-600" id="display-target">0</div>
                            </div>
                        </div>

                        <!-- KRW Row -->
                        <div id="row-krw" class="currency-row flex items-center justify-between p-4 rounded-2xl cursor-pointer bg-gray-50" data-code="KRW">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">ğŸ‡°ğŸ‡·</span>
                                <span class="font-bold text-gray-700">KRW</span>
                                <span class="text-blue-600 text-xs font-bold active-label hidden">ì…ë ¥ ì¤‘</span>
                            </div>
                            <div class="text-right">
                                <div class="expression-display" id="expr-KRW"></div>
                                <div class="text-xl font-bold tracking-tight text-gray-700" id="display-KRW">0</div>
                            </div>
                        </div>
                    </div>

                    <!-- ìˆ«ì í‚¤íŒ¨ë“œ -->
                    <div class="grid grid-cols-4 gap-2">
                        <div class="keypad-button bg-orange-50 text-orange-600 font-bold p-4 rounded-xl text-center cursor-pointer text-xl" data-key="C">C</div>
                        <div class="keypad-button bg-blue-50 text-blue-600 font-bold p-4 rounded-xl text-center cursor-pointer text-xl" data-key="/">Ã·</div>
                        <div class="keypad-button bg-blue-50 text-blue-600 font-bold p-4 rounded-xl text-center cursor-pointer text-xl" data-key="*">Ã—</div>
                        <div class="keypad-button bg-gray-100 text-gray-600 font-bold p-4 rounded-xl text-center cursor-pointer text-xl" data-key="DEL">âŒ«</div>

                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="7">7</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="8">8</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="9">9</div>
                        <div class="keypad-button bg-blue-50 text-blue-600 font-bold p-4 rounded-xl text-center cursor-pointer text-xl" data-key="-">âˆ’</div>

                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="4">4</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="5">5</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="6">6</div>
                        <div class="keypad-button bg-blue-50 text-blue-600 font-bold p-4 rounded-xl text-center cursor-pointer text-xl" data-key="+">+</div>

                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="1">1</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="2">2</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl" data-key="3">3</div>
                        <div class="keypad-button bg-blue-600 text-white font-bold p-4 rounded-xl text-center cursor-pointer text-xl row-span-2 flex items-center justify-center" data-key="=">=</div>

                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl col-span-2" data-key="0">0</div>
                        <div class="keypad-button bg-gray-50 text-gray-700 font-medium p-4 rounded-xl text-center cursor-pointer text-xl font-black" id="dot-key" data-key=".">.</div>
                    </div>
                </div>
            </section>

            <!-- ë¦¬í¬íŠ¸ ì„¹ì…˜ 2: ì¶”ì„¸ ë¶„ì„ -->
            <section class="lg:col-span-7 space-y-8">
                <div class="bg-white rounded-3xl shadow-sm border border-gray-100 p-8 h-full flex flex-col">
                    <h2 class="text-xl font-bold mb-4" id="chart-title">PHP/KRW ì‹œì¥ ë™í–¥</h2>
                    <div class="flex-grow flex flex-col justify-center">
                        <div class="chart-container">
                            <canvas id="trendsChart"></canvas>
                        </div>
                    </div>
                    <div class="mt-8 grid grid-cols-2 gap-4">
                        <div class="p-4 bg-gray-50 rounded-2xl">
                            <div class="text-xs text-gray-400 mb-1">ìµœê³ ì¹˜ (7ì¼)</div>
                            <div class="text-lg font-bold text-gray-700" id="stat-high">0 â‚©</div>
                        </div>
                        <div class="p-4 bg-gray-50 rounded-2xl">
                            <div class="text-xs text-gray-400 mb-1">ìµœì €ì¹˜ (7ì¼)</div>
                            <div class="text-lg font-bold text-gray-700" id="stat-low">0 â‚©</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- í•˜ë‹¨ ì •ë³´ ì„¹ì…˜ -->
        <footer class="mt-12 text-center text-gray-400 text-xs">
            <p>Â© 2026 í™˜ìœ¨ NOW | ë°ì´í„° ì œê³µ: ê³µê³µë°ì´í„°í¬í„¸ ë° ê¸ˆìœµì‹œì¥ ì •ë³´ ì‹œìŠ¤í…œ</p>
        </footer>
    </div>

    <script>
        // State Management
        const state = {
            view: 'PHP', 
            activeCurrency: 'PHP', 
            inputValue: '0', 
            rates: {
                PHP: 24.91,
                USD: 1442.50,
                THB: 39.75,
                VND: 0.056
            }
        };

        const viewConfig = {
            PHP: { flag: 'ğŸ‡µğŸ‡­', code: 'PHP', logo: 'â‚±', precision: 0, data: [24.81, 24.85, 24.98, 24.92, 24.88, 24.94, 24.91] },
            USD: { flag: 'ğŸ‡ºğŸ‡¸', code: 'USD', logo: '$', precision: 2, data: [1439.5, 1441.2, 1445.8, 1443.1, 1442.4, 1444.2, 1442.5] },
            THB: { flag: 'ğŸ‡¹ğŸ‡­', code: 'THB', logo: 'à¸¿', precision: 1, data: [39.4, 39.5, 39.8, 39.7, 39.6, 39.8, 39.75] },
            VND: { flag: 'ğŸ‡»ğŸ‡³', code: 'VND', logo: 'â‚«', precision: 0, data: [0.054, 0.055, 0.057, 0.056, 0.055, 0.056, 0.056] }
        };

        const displays = {
            KRW: document.getElementById('display-KRW'),
            target: document.getElementById('display-target'),
            exprKRW: document.getElementById('expr-KRW'),
            exprTarget: document.getElementById('expr-PHP')
        };

        const safeEval = (str) => {
            try {
                // Clean input for evaluation
                const cleanStr = str.replace(/[^-+/*0-9.]/g, '');
                if (!cleanStr) return 0;
                // eslint-disable-next-line no-new-func
                const result = Function('"use strict";return (' + cleanStr + ')')();
                return isFinite(result) ? result : 0;
            } catch (e) {
                return null;
            }
        };

        const updateCalculations = () => {
            let resultValue = safeEval(state.inputValue);
            if (resultValue === null) return; // Keep previous result if expression is mid-typing

            const rate = state.rates[state.view];
            const config = viewConfig[state.view];
            
            let targetValue, krwValue;

            if (state.activeCurrency === 'KRW') {
                krwValue = resultValue;
                targetValue = resultValue / rate;
                displays.exprKRW.textContent = state.inputValue === '0' ? '' : state.inputValue;
                displays.exprTarget.textContent = '';
            } else {
                targetValue = resultValue;
                krwValue = resultValue * rate;
                displays.exprTarget.textContent = state.inputValue === '0' ? '' : state.inputValue;
                displays.exprKRW.textContent = '';
            }

            const targetPrecision = config.precision;
            const krwFormatter = new Intl.NumberFormat('ko-KR', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
            const targetFormatter = new Intl.NumberFormat('ko-KR', { minimumFractionDigits: targetPrecision, maximumFractionDigits: targetPrecision });

            displays.KRW.textContent = krwFormatter.format(Math.round(krwValue));
            displays.target.textContent = targetFormatter.format(targetValue);
        };

        const updateVisualActiveState = () => {
            const rows = [document.getElementById('row-target'), document.getElementById('row-krw')];
            rows.forEach(row => {
                const code = row.getAttribute('data-code');
                const label = row.querySelector('.active-label');
                const display = row.querySelector('div[id^="display-"]');
                if (code === state.activeCurrency) {
                    row.classList.add('active');
                    label.classList.remove('hidden');
                    display.classList.add('text-blue-600');
                    display.classList.remove('text-gray-700');
                } else {
                    row.classList.remove('active');
                    label.classList.add('hidden');
                    display.classList.remove('text-blue-600');
                    display.classList.add('text-gray-700');
                }
            });
        };

        const switchView = (viewCode) => {
            state.view = viewCode;
            state.activeCurrency = viewCode;
            state.inputValue = '0';
            const config = viewConfig[viewCode];
            
            ['php', 'usd', 'thb', 'vnd'].forEach(c => {
                document.getElementById(`nav-${c}`).className = (c === viewCode.toLowerCase()) ? 'nav-tab active px-4 sm:px-6 py-2 font-bold text-sm transition-all' : 'nav-tab px-4 sm:px-6 py-2 font-bold text-sm text-gray-400 transition-all';
            });
            
            document.getElementById('logo-icon').textContent = config.logo;
            document.getElementById('target-flag').textContent = config.flag;
            document.getElementById('target-code').textContent = config.code;
            document.getElementById('row-target').setAttribute('data-code', config.code);
            document.getElementById('chart-title').textContent = config.code + '/KRW ì‹œì¥ ë™í–¥';

            updateVisualActiveState();
            updateCalculations();
            initChart();
        };

        document.querySelectorAll('.keypad-button').forEach(btn => {
            btn.addEventListener('click', () => {
                const key = btn.getAttribute('data-key');
                if (!key) return;

                if (key === 'C') {
                    state.inputValue = '0';
                } else if (key === '=') {
                    const result = safeEval(state.inputValue);
                    if (result !== null) state.inputValue = result.toString();
                } else if (key === 'DEL') {
                    state.inputValue = state.inputValue.toString().slice(0, -1) || '0';
                    if (state.inputValue === '') state.inputValue = '0';
                } else if (['+', '-', '*', '/'].includes(key)) {
                    const lastChar = state.inputValue.slice(-1);
                    if (['+', '-', '*', '/'].includes(lastChar)) {
                        state.inputValue = state.inputValue.slice(0, -1) + key;
                    } else {
                        state.inputValue += key;
                    }
                } else if (key === '.') {
                    const parts = state.inputValue.split(/[+\-*/]/);
                    if (!parts[parts.length - 1].includes('.')) state.inputValue += '.';
                } else if (!isNaN(key)) {
                    if (state.inputValue === '0') state.inputValue = key;
                    else state.inputValue += key;
                }
                updateCalculations();
            });
        });

        [document.getElementById('row-target'), document.getElementById('row-krw')].forEach(row => {
            row.addEventListener('click', () => {
                state.activeCurrency = row.getAttribute('data-code');
                const displayId = state.activeCurrency === 'KRW' ? 'display-KRW' : 'display-target';
                state.inputValue = document.getElementById(displayId).textContent.replace(/,/g, '');
                updateVisualActiveState();
                updateCalculations();
            });
        });

        let currentChart;
        const initChart = () => {
            if (currentChart) currentChart.destroy();
            const config = viewConfig[state.view];
            document.getElementById('stat-high').textContent = Math.max(...config.data).toLocaleString() + ' â‚©';
            document.getElementById('stat-low').textContent = Math.min(...config.data).toLocaleString() + ' â‚©';
            currentChart = new Chart(document.getElementById('trendsChart'), {
                type: 'line',
                data: {
                    labels: ['02/12', '02/13', '02/14', '02/15', '02/16', '02/17', '02/18'],
                    datasets: [{ label: config.code + '/KRW', data: config.data, borderColor: '#2563eb', backgroundColor: '#2563eb1a', fill: true, tension: 0.4, pointRadius: 4, borderWidth: 3 }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { ticks: { font: { size: 10 } } }, x: { grid: { display: false }, ticks: { font: { size: 10 } } } } }
            });
        };

        window.onload = () => switchView('PHP');
    </script>
</body>
</html>
